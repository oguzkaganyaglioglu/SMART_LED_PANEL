<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Update Firmware</title>
    <link rel="stylesheet" href="/updateStyle.css"/>
    <link href="/fonts/woff2/montserrat.css" rel="stylesheet"/>
</head>
<body>
<section class="container-loading" id="loadingPage">
    <div>
        <div id="loadingTitle"></div>
        <div class="triangle">
            <svg
                    xmlns="http://www.w3.org/2000/svg"
                    style="transform: translateY(-7.1px)"
                    width="96.22"
                    height="87.949"
                    viewBox="0 0 96.22 87.949"
            >
                <path
                        id="Polygon_1_-_Outline"
                        data-name="Polygon 1 - Outline"
                        d="M60.5,24.051a9.9,9.9,0,0,0-8.665,5.008L20.751,83.008A10,10,0,0,0,29.415,98H91.585a10,10,0,0,0,8.665-14.992L69.165,29.059A9.9,9.9,0,0,0,60.5,24.051m0-7a16.84,16.84,0,0,1,14.73,8.513l31.085,53.949A17,17,0,0,1,91.585,105H29.415a17,17,0,0,1-14.73-25.487L45.77,25.564A16.84,16.84,0,0,1,60.5,17.051Z"
                        transform="translate(-12.39 -17.051)"
                        fill="#fff"
                />
            </svg>
        </div>
    </div>
</section>
<section class="container" id="updatePage">
    <svg
            xmlns="http://www.w3.org/2000/svg"
            width="121"
            height="105"
            viewBox="0 0 121 105"
    >
        <g id="Polygon_1" data-name="Polygon 1" fill="rgba(255,255,255,0)">
            <path
                    d="M 91.58470153808594 101.5 L 29.4153003692627 101.5 C 26.90004920959473 101.5 24.56646728515625 100.8644332885742 22.47934913635254 99.61093902587891 C 20.52935028076172 98.43976593017578 18.88596725463867 96.76065063476562 17.72688293457031 94.75508880615234 C 16.56781578063965 92.74953460693359 15.9333667755127 90.48731994628906 15.89213371276855 88.21300506591797 C 15.8480167388916 85.77881622314453 16.46235084533691 83.43955230712891 17.71808242797852 81.26018524169922 L 48.80278396606445 27.3115348815918 C 50.06033325195312 25.12898635864258 51.77883148193359 23.4227180480957 53.9105339050293 22.2401180267334 C 55.90200042724609 21.13531875610352 58.18059921264648 20.55135154724121 60.5 20.55135154724121 C 62.81938171386719 20.55135154724121 65.09798431396484 21.13531875610352 67.08946990966797 22.2401180267334 C 69.22115325927734 23.4227180480957 70.93965148925781 25.12898635864258 72.19719696044922 27.3115348815918 L 103.2818984985352 81.26018524169922 C 104.5376358032227 83.43955230712891 105.151969909668 85.77881622314453 105.1078491210938 88.21300506591797 C 105.0666351318359 90.48731994628906 104.4321823120117 92.74951934814453 103.2731018066406 94.75508880615234 C 102.1140365600586 96.76065063476562 100.4706497192383 98.43976593017578 98.52065277099609 99.61093902587891 C 96.43353271484375 100.8644332885742 94.09995269775391 101.5 91.58470153808594 101.5 Z"
                    stroke="none"
            />
            <path
                    d="M 60.5 24.05133056640625 C 56.88117980957031 24.05133056640625 53.64208221435547 25.92330932617188 51.83540344238281 29.05886840820312 L 20.75067901611328 83.00753021240234 C 18.94671630859375 86.13836669921875 18.94915771484375 89.87528991699219 20.75721740722656 93.00376892089844 C 22.56526184082031 96.13224792480469 25.80191802978516 97.99998474121094 29.41529846191406 97.99998474121094 L 91.58470153808594 97.99998474121094 C 95.19808197021484 97.99998474121094 98.43473815917969 96.13224792480469 100.2427825927734 93.00376892089844 C 102.0508193969727 89.87528991699219 102.0532608032227 86.13836669921875 100.2492980957031 83.00753021240234 L 69.16459655761719 29.05886840820312 C 67.35792541503906 25.92330932617188 64.11882019042969 24.05133056640625 60.5 24.05133056640625 M 60.5 17.05133056640625 C 66.22991180419922 17.05133056640625 71.95982360839844 19.88893890380859 75.22982025146484 25.56414794921875 L 106.3145217895508 79.51280975341797 C 112.8446807861328 90.84614562988281 104.6647415161133 104.9999847412109 91.58470153808594 104.9999847412109 L 29.41529846191406 104.9999847412109 C 16.33525848388672 104.9999847412109 8.155319213867188 90.84614562988281 14.68546295166016 79.51280975341797 L 45.77017974853516 25.56414794921875 C 49.04017639160156 19.88893890380859 54.77008819580078 17.05133056640625 60.5 17.05133056640625 Z"
                    stroke="none"
                    fill="#fff"
            />
        </g>
    </svg>

    <form
            method="POST"
            action="/update"
            id="updateForm"
            enctype="multipart/form-data"
    >
        <div id="fileSelect">
            <label for="file-select" id="file-select-label">Select File</label>
            <span id="file-name"></span>
        </div>
        <input type="file" id="file-select" name="update"/>
        <input type="submit" value="Update" id="file-submit" disabled/>
    </form>
</section>
<section class="update-result" id="updateFailed">
    <div class="triangle">
        <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="121"
                height="105"
                viewBox="0 0 121 105"
        >
            <defs>
                <filter
                        id="Polygon_3"
                        x="0"
                        y="0"
                        width="331"
                        height="315"
                        filterUnits="userSpaceOnUse"
                >
                    <feOffset input="SourceAlpha"/>
                    <feGaussianBlur stdDeviation="35" result="blur"/>
                    <feFlood flood-color="#ff5d5d"/>
                    <feComposite operator="in" in2="blur"/>
                    <feComposite in="SourceGraphic"/>
                </filter>
            </defs>
            <g transform="matrix(1, 0, 0, 1, 0, 0)" filter="url(#Polygon_3)">
                <g
                        id="Polygon_3-2"
                        data-name="Polygon 3"
                        transform="translate(105 105)"
                        fill="rgba(255,255,255,0)"
                >
                    <path
                            d="M 91.58470153808594 101.5 L 29.4153003692627 101.5 C 26.90004920959473 101.5 24.56646728515625 100.8644332885742 22.47934913635254 99.61093902587891 C 20.52935028076172 98.43976593017578 18.88596725463867 96.76065063476562 17.72688293457031 94.75508880615234 C 16.56781578063965 92.74953460693359 15.9333667755127 90.48731994628906 15.89213371276855 88.21300506591797 C 15.8480167388916 85.77881622314453 16.46235084533691 83.43955230712891 17.71808242797852 81.26018524169922 L 48.80278396606445 27.3115348815918 C 50.06033325195312 25.12898635864258 51.77883148193359 23.4227180480957 53.9105339050293 22.2401180267334 C 55.90200042724609 21.13531875610352 58.18059921264648 20.55135154724121 60.5 20.55135154724121 C 62.81938171386719 20.55135154724121 65.09798431396484 21.13531875610352 67.08946990966797 22.2401180267334 C 69.22115325927734 23.4227180480957 70.93965148925781 25.12898635864258 72.19719696044922 27.3115348815918 L 103.2818984985352 81.26018524169922 C 104.5376358032227 83.43955230712891 105.151969909668 85.77881622314453 105.1078491210938 88.21300506591797 C 105.0666351318359 90.48731994628906 104.4321823120117 92.74951934814453 103.2731018066406 94.75508880615234 C 102.1140365600586 96.76065063476562 100.4706497192383 98.43976593017578 98.52065277099609 99.61093902587891 C 96.43353271484375 100.8644332885742 94.09995269775391 101.5 91.58470153808594 101.5 Z"
                            stroke="none"
                    />
                    <path
                            d="M 60.5 24.05133056640625 C 56.88117980957031 24.05133056640625 53.64208221435547 25.92330932617188 51.83540344238281 29.05886840820312 L 20.75067901611328 83.00753021240234 C 18.94671630859375 86.13836669921875 18.94915771484375 89.87528991699219 20.75721740722656 93.00376892089844 C 22.56526184082031 96.13224792480469 25.80191802978516 97.99998474121094 29.41529846191406 97.99998474121094 L 91.58470153808594 97.99998474121094 C 95.19808197021484 97.99998474121094 98.43473815917969 96.13224792480469 100.2427825927734 93.00376892089844 C 102.0508193969727 89.87528991699219 102.0532608032227 86.13836669921875 100.2492980957031 83.00753021240234 L 69.16459655761719 29.05886840820312 C 67.35792541503906 25.92330932617188 64.11882019042969 24.05133056640625 60.5 24.05133056640625 M 60.5 17.05133056640625 C 66.22991180419922 17.05133056640625 71.95982360839844 19.88893890380859 75.22982025146484 25.56414794921875 L 106.3145217895508 79.51280975341797 C 112.8446807861328 90.84614562988281 104.6647415161133 104.9999847412109 91.58470153808594 104.9999847412109 L 29.41529846191406 104.9999847412109 C 16.33525848388672 104.9999847412109 8.155319213867188 90.84614562988281 14.68546295166016 79.51280975341797 L 45.77017974853516 25.56414794921875 C 49.04017639160156 19.88893890380859 54.77008819580078 17.05133056640625 60.5 17.05133056640625 Z"
                            stroke="none"
                            fill="#ff5d5d"
                    />
                </g>
            </g>
        </svg>
    </div>
    <h1>Update Failed</h1>
</section>
<section class="update-result" id="updateSucccess">
    <div class="triangle">
        <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="121"
                height="105"
                viewBox="0 0 121 105"
        >
            <defs>
                <filter
                        id="Polygon_4"
                        x="0"
                        y="0"
                        width="331"
                        height="315"
                        filterUnits="userSpaceOnUse"
                >
                    <feOffset input="SourceAlpha"/>
                    <feGaussianBlur stdDeviation="35" result="blur"/>
                    <feFlood flood-color="#98ffc8"/>
                    <feComposite operator="in" in2="blur"/>
                    <feComposite in="SourceGraphic"/>
                </filter>
            </defs>
            <g transform="matrix(1, 0, 0, 1, 0, 0)" filter="url(#Polygon_4)">
                <g
                        id="Polygon_4-2"
                        data-name="Polygon 4"
                        transform="translate(105 105)"
                        fill="rgba(255,255,255,0)"
                >
                    <path
                            d="M 91.58470153808594 101.5 L 29.4153003692627 101.5 C 26.90004920959473 101.5 24.56646728515625 100.8644332885742 22.47934913635254 99.61093902587891 C 20.52935028076172 98.43976593017578 18.88596725463867 96.76065063476562 17.72688293457031 94.75508880615234 C 16.56781578063965 92.74953460693359 15.9333667755127 90.48731994628906 15.89213371276855 88.21300506591797 C 15.8480167388916 85.77881622314453 16.46235084533691 83.43955230712891 17.71808242797852 81.26018524169922 L 48.80278396606445 27.3115348815918 C 50.06033325195312 25.12898635864258 51.77883148193359 23.4227180480957 53.9105339050293 22.2401180267334 C 55.90200042724609 21.13531875610352 58.18059921264648 20.55135154724121 60.5 20.55135154724121 C 62.81938171386719 20.55135154724121 65.09798431396484 21.13531875610352 67.08946990966797 22.2401180267334 C 69.22115325927734 23.4227180480957 70.93965148925781 25.12898635864258 72.19719696044922 27.3115348815918 L 103.2818984985352 81.26018524169922 C 104.5376358032227 83.43955230712891 105.151969909668 85.77881622314453 105.1078491210938 88.21300506591797 C 105.0666351318359 90.48731994628906 104.4321823120117 92.74951934814453 103.2731018066406 94.75508880615234 C 102.1140365600586 96.76065063476562 100.4706497192383 98.43976593017578 98.52065277099609 99.61093902587891 C 96.43353271484375 100.8644332885742 94.09995269775391 101.5 91.58470153808594 101.5 Z"
                            stroke="none"
                    />
                    <path
                            d="M 60.5 24.05133056640625 C 56.88117980957031 24.05133056640625 53.64208221435547 25.92330932617188 51.83540344238281 29.05886840820312 L 20.75067901611328 83.00753021240234 C 18.94671630859375 86.13836669921875 18.94915771484375 89.87528991699219 20.75721740722656 93.00376892089844 C 22.56526184082031 96.13224792480469 25.80191802978516 97.99998474121094 29.41529846191406 97.99998474121094 L 91.58470153808594 97.99998474121094 C 95.19808197021484 97.99998474121094 98.43473815917969 96.13224792480469 100.2427825927734 93.00376892089844 C 102.0508193969727 89.87528991699219 102.0532608032227 86.13836669921875 100.2492980957031 83.00753021240234 L 69.16459655761719 29.05886840820312 C 67.35792541503906 25.92330932617188 64.11882019042969 24.05133056640625 60.5 24.05133056640625 M 60.5 17.05133056640625 C 66.22991180419922 17.05133056640625 71.95982360839844 19.88893890380859 75.22982025146484 25.56414794921875 L 106.3145217895508 79.51280975341797 C 112.8446807861328 90.84614562988281 104.6647415161133 104.9999847412109 91.58470153808594 104.9999847412109 L 29.41529846191406 104.9999847412109 C 16.33525848388672 104.9999847412109 8.155319213867188 90.84614562988281 14.68546295166016 79.51280975341797 L 45.77017974853516 25.56414794921875 C 49.04017639160156 19.88893890380859 54.77008819580078 17.05133056640625 60.5 17.05133056640625 Z"
                            stroke="none"
                            fill="#98ffc8"
                    />
                </g>
            </g>
        </svg>
    </div>
    <h1>Successfully<br/>Updated</h1>
</section>
<footer>PERFECT LIGHTS SMART LED PANEL by Oğuz Kağan Yağlıoğlu</footer>
</body>
<script>
    const fileSelect = document.getElementById("file-select");
    const fileName = document.getElementById("file-name");
    const fileSubmit = document.getElementById("file-submit");
    const updatePage = document.getElementById("updatePage");
    const loadingPage = document.getElementById("loadingPage");
    const loadingTitle = document.getElementById("loadingTitle");
    const updateForm = document.getElementById("updateForm");
    const successPage = document.getElementById("updateSucccess");
    const failedPage = document.getElementById("updateFailed");

    const setLoadingPage = (open, title = "") => {
        loadingTitle.innerHTML = title;
        loadingPage.style.display = open === true ? "flex" : "none";
        updatePage.style.display = open === true ? "none" : "flex";
    };

    fileSelect.addEventListener("change", (e) => {
        fileName.title = e.target.files[0].name;
        fileName.innerText = e.target.files[0].name;
        fileSubmit.disabled = false;
    });

    const sendForm = () => {
        const request = new XMLHttpRequest();
        const formData = new FormData(updateForm);
        request.addEventListener("load", function (event) {
            setLoadingPage(false);
            updatePage.style.display = "none";
            if (event.target.responseText === "OK")
                successPage.style.display = "flex";
            else failedPage.style.display = "flex";
        });
        request.addEventListener("error", function (event) {
            alert("Oops! Something went wrong.");
        });
        request.open("POST", "/update");
        request.send(formData);
    };

    updateForm.addEventListener("submit", (e) => {
        e.preventDefault();
        setLoadingPage(true, "UPDATING, PLEASE WAIT");
        sendForm();
    });
</script>
</html>
